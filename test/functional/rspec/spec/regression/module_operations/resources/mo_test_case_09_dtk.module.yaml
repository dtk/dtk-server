---
module: test_ns/unit_test_9
version: master
dependencies:
  aws/ec2: master
  r8/stdlib: master
assemblies:
  simple_link:
    components:
    - node[source]:
        attributes:
          image: precise
          size: micro
        components:
        - stdlib
        - unit_test_9::attribute_test
        - unit_test_9::source:
            links:
              unit_test_9::sink:
              - sink/unit_test_9::sink
    - node[sink]:
        attributes:
          image: precise
          size: micro
        components:
        - stdlib
        - unit_test_9::sink
  fan_in:
    components:
    - node[source1]:
        attributes:
          image: precise
          size: micro
        components:
        - stdlib
        - unit_test_9::source:
            links:
              unit_test_9::sink:
              - sink/unit_test_9::sink
    - node[source2]:
        attributes:
          image: precise
          size: micro
        components:
        - stdlib
        - unit_test_9::source:
            component_links:
              unit_test_9::sink:
              - sink/unit_test_9::sink
    - node[sink]:
        attributes:
          image: precise
          size: micro
        components:
        - stdlib
        - unit_test_9::sink
  fan_out:
    components:
    - node[source1]:
        attributes:
          image: precise_hvm
          size: small
        components:
        - stdlib
        - unit_test_9::source:
            component_links:
              unit_test_9::sink:
              - sink1/unit_test_9::sink
              - sink2/unit_test_9::sink
    - node[sink1]:
        attributes:
          image: precise
          size: micro
        components:
        - stdlib
        - unit_test_9::sink
    - node[sink2]:
        attributes:
          image: precise
          size: micro
        components:
        - stdlib
        - unit_test_9::sink
component_defs:
  sink:
    actions:
      create:
        puppet_class: unit_test::sink
  source:
    actions:
      create:
        puppet_class: unit_test::source
    attributes:
      upstream:
        type: array
        required: true
    dependencies:
      unit_test::sink:
        location: remote
    link_defs:
      unit_test::sink:
      - location: remote
        attribute_mappings:
        - "$node.host_address -> upstream"
  attribute_test:
    actions:
      create:
        puppet_class: unit_test::attribute_test
    attributes:
      array_attr:
        type: array
        default:
      hash_attr:
        type: hash
        default:
          key1:
          - element1
          - element2
      boolean_attr:
        type: boolean
        default: false
      port_attr:
        type: port
        default: 7000
      integer_attr:
        type: integer
        default: 878
      required_attr:
        required: true
      new_port:
        type: port